{if isset($buildData) && isset($buildData['buildForm'])}
<style type="text/css">
    .layui-form-item{padding-top:15px;}
    .layui-form-item .layui-form-label{
        width:12%;
        text-align: right;
        white-space: nowrap;
        color: #333;
        font-weight: 500;
    }
    .layui-form-label:after{
        content: ":";
        position: relative;
        top: -.5px;
        margin: 0 8px 0 2px;
    }
    .no-after:after{
        content: "";
    }
    .layui-form-item .layui-input-inline{width:40%;}
    .layui-form-item .hi-editor{width:80%;}
    .layui-form-item .layui-input, .layui-form-item .layui-textarea{width: 100%}
    .layui-form-mid{ padding-left:15px !important;}
    .layui-form-mid code {color: #5FB878;}
    .buildForm{
        background-color: #fff;
        padding:10px;
    }
</style>
{if !isset($buildData['buildForm']['hiData']['pop'])}
<style>
    .layui-form-item .layui-form-label{width: 8%;}
</style>
{/if}
{include file="block/layui" /}
{if !isset($tabType) || !$tabType}
<div class="buildForm">
{/if}
<form class="layui-form" action="{:$buildData['buildForm']['action']}" method="{$buildData['buildForm']['method']}">
    <div class="page-form">
        {volist name="buildData['buildForm']['items']" id="v"}
        {switch name="v['type']"}
        {case value="line"}
        <!--标题分割线-->
        <div class="layui-form-item">
            <div class="site-title">
            <fieldset class="layui-elem-field layui-field-title">
                <legend>{$v['title']}</legend>
            </fieldset>
            </div>
        </div>
        {/case}
        {case value="textarea"}
        <!--多行文本-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <textarea rows="6"  class="layui-textarea field-{$v['name']}" name="{$v['name']}" autocomplete="off"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if} placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请填写{$v['title']}{/if}">{if isset($v['value'])}{:htmlspecialchars_decode($v['value'])}{/if}</textarea>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="array"}
        <!--文本域-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <textarea rows="6" class="layui-textarea field-{$v['name']}" name="{$v['name']}" autocomplete="off" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请填写{$v['title']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>{if isset($v['value'])}{:htmlspecialchars_decode($v['value'])}{/if}</textarea>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="switch"}
        <!--开关-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="checkbox" class="field-{$v['name']}" name="{$v['name']}" value="1" lay-skin="switch"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if} lay-text="{$v['options'][1]}|{$v['options'][0]}" {if isset($v['value']) && $v['value'] == 1}checked=""{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="select"}
        <!--下拉框-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <select class="field-{$v['name']}" name="{$v['name']}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
                    {volist name="v['options']" id="vv"}
                    <option value="{$key}" {if isset($v['value']) && $key == $v['value']}selected{/if}>{$vv}</option>
                    {/volist}
                </select>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="radio"}
        <!--单选-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                {volist name="v['options']" id="vv"}
                <input type="radio" class="field-{$v['name']}" name="{$v['name']}" value="{$key}" title="{$vv}" {if isset($v['value']) && $key == $v['value']}checked{/if}>
                {/volist}
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="checkbox"}
        <!--多选-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                {volist name="v['options']" id="vv"}
                <input type="checkbox" class="field-{$v['name']}" name="{$v['name']}[]" value="{$key}" title="{$vv}" lay-skin="primary" {if isset($v['value']) && in_array($key, str_to_array($v['value'], ','))}checked{/if}>
                {/volist}
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="date"}
        <!--日期-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input layui-date field-{$v['name']}" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}" autocomplete="off" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请填写{$v['title']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="datetime"}
        <!--日期+时间-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input layui-date field-{$v['name']}" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}" autocomplete="off" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请填写{$v['title']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="image"}
        <!--图片-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline upload">
                <button type="button" name="upload" class="layui-btn layui-btn-primary layui-upload" data-url="{if isset($v['url'])}{$v['url']}{/if}" lay-data="{accept:'image'}" lay-type="image">请上传{$v['title']}</button>
                <input type="hidden" class="upload-input" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
                {if condition="$v['value']"}
                <img src="{$v['value']}" type="img"  class="field-{$v['name']}" style="display:inline-block;border-radius:5px;border:1px solid #ccc" width="36" height="36">
                {else /}
                <img src="" style="display:none;border-radius:5px;border:1px solid #ccc" type="img" class="field-{$v['name']}" width="36" height="36">
                {/if}
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="file"}
        <!--文件-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline upload">
                <button type="button" name="upload" class="layui-btn layui-btn-primary layui-upload" data-url="{if isset($v['url'])}{$v['url']}{/if}" lay-data="{accept:'file'}">请上传{$v['title']}</button>
                <input type="hidden" class="upload-input" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="color"}
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="text" class="field-{$v['name']}" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请选择颜色{/if}" class="layui-input color_{$v['name']}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-inline">
                <div class="color-form-{$v['name']}"></div>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        <script type="application/javascript">
            layui.use(['colorpicker'], function() {
                var $ = layui.jquery, colorpicker = layui.colorpicker;
                colorpicker.render({
                    elem: '.color-form-{$v["name"]}'
                    ,color: '{if $v["value"]}{$v["value"]}{else/}#1c97f5{/if}'
                    ,done: function(color){
                        $('.color_{$v["name"]}').val(color);
                    }
                });
            })
        </script>
        {/case}
        {case value="password"}
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="password" class="layui-input field-{$v['name']}" name="{$v['name']}" autocomplete="off" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/case}
        {case value="hidden"}
        <input type="hidden" class="field-{$v['name']}" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}">
        {/case}
        {case value="editor"}
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline hi-editor">
                {if isset($v['editor']) && in_array($v['editor'],['umeditor','ueditor'])}
                <div id="{$v['name']}" class="field-editor" type="editor" editor="{if isset($v['editor'])}{$v['editor']}{/if}">{if isset($v['value'])}{$v['value']}{/if}</div>
                {else/}
                <textarea id="{$v['name']}" name="{$v['name']}" class="field-{$v['name']}" type="editor" editor="{if isset($v['editor'])}{$v['editor']}{/if}"></textarea>
                {/if}
                {if isset($v['editor'])}
                {:editor([$v['name']], $buildData['buildForm']['upload_group'], $v['editor'])}
                {else/}
                {:editor([$v['name']], $buildData['buildForm']['upload_group'])}
                {/if}
            </div>
        </div>
        {/case}
        {default /}
        <!--单行文本-->
        <div class="layui-form-item">
            <label class="layui-form-label">{$v['title']}</label>
            <div class="layui-input-inline">
                <input type="text" class="layui-input field-{$v['name']}" name="{$v['name']}" value="{if isset($v['value'])}{$v['value']}{/if}" autocomplete="off" placeholder="{if isset($v['placeholder'])}{$v['placeholder']}{else/}请填写{$v['title']}{/if}"{if isset($v['verify'])} lay-verify="{$v['verify']}"{/if}>
            </div>
            <div class="layui-form-mid layui-word-aux">{if isset($v['tips'])}{:htmlspecialchars_decode($v['tips'])}{/if}</div>
        </div>
        {/switch}
        {/volist}
        <div class="layui-form-item">
            <label class="layui-form-label no-after"> </label>
            <div class="layui-input-block">
                {if $buildData['buildForm']['token'] == true}{:token()}{/if}
                <button type="submit" class="layui-btn layui-btn-normal" lay-submit="" {if isset($buildData['buildForm']['hiData'])}hi-data={:json_encode($buildData['buildForm']['hiData'])}{/if} lay-filter="formSubmit">{$buildData['buildForm']['submitBtn']['title']}</button>
                {if !isset($buildData['buildForm']['hiData']['pop'])}
                <a href="{if $buildData['buildForm']['backBtn'] == true}{:url($buildData['buildForm']['backBtn'])}{else/}javascript:window.history.back(-1);{/if}" class="layui-btn layui-btn-primary ml10"><i class="aicon ai-fanhui"></i>返回</a>
                {/if}
            </div>
        </div>
    </div>
</form>
{if !isset($tabType)}
</div>
{/if}
<script>
    layui.use(['jquery', 'laydate', 'upload', 'func'], function() {
        var $ = layui.jquery, laydate = layui.laydate, layer = layui.layer, upload = layui.upload;

        layui.func.assign({:json_encode($formData)});

        $('.layui-upload').each(function(i) {
            var url = $(this).attr('data-url') == '' ? '{if isset($buildData["buildForm"]["upload_group"])}{:url("system/annex/upload?group=".$buildData["buildForm"]["upload_group"])}{/if}' : $(this).attr('data-url');
            upload.render({
                elem: $('.layui-upload')[i]
                ,url: url
                ,method: 'post'
                ,before: function(input) {
                    layer.msg('文件上传中...', {time:3000000});
                },done: function(res, obj) {
                    var obj = this.item;
                    if (res.code == 0) {
                        layer.msg(res.msg);
                        return false;
                    }
                    layer.closeAll();
                    var input = $(obj).parents('.upload').find('.upload-input');
                    if ($(obj).attr('lay-type') == 'image') {
                        input.siblings('img').attr('src', res.data.file).show();
                    }
                    input.val(res.data.file);
                }
            });
        });

        /* 绑定多个日期控件 */
        $('.layui-date').each(function(i) {
            laydate.render({
                elem: this
                ,trigger: 'click'
            });
        });

    });
</script>
{/if}